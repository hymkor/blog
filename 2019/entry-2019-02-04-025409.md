Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2019/02/04/025409
Rem: App-Edited: 2019-02-04T23:57:12+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/98012380857072788
Rem: Published: 2019-02-04T02:54:09+09:00
Category: go
Updated: 2019-02-04T02:54:09+09:00
Title:  ("bufio".Reader) ReadString('\n') と ("bufio".Scanner) Scan() の違い
---
違い
===

* `("bufio".Reader) ReadString('\n')`
    * 改行をカットしない
* `("bufio".Scanner) Scan()`
    * 改行をカットする

改行コードのない最終行の扱い
=====================

最後の行が `abcd`(EOF) というテキストの場合

* `("bufio".Reader) ReadString('\n')`
    * `"abcd",io.EOF` という戻り値となる
* `("bufio".Scanner) Scan()`
    * `Text()` は "abcd" という戻り値を返し、その**次**の `Scan()` が false になる

Scanner の方は定番である

```go
for sc.Scan() {
   line := sc.Text()
   fmt.Println(line)
}
```

という書き方で問題ないが、Reader の方は

```go
for{
    line,err := r.ReadString('\n')
    if err != nil {
        break
    }
    fmt.Print(line)
}
```

だと、最後の行が抜けてしまう。

```go
for{
    line,err := r.ReadString('\n')
    fmt.Print(line)
    if err != nil {
        break
    }
}
```

と書かないといけない。こう書くと Scanner の方が常に正しいように思われるが、Scanner は最終行の改行の有無がわからないという問題がある。