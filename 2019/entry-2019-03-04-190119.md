```header
Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2019/03/04/190119
Rem: App-Edited: 2019-05-07T22:46:40+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/17680117126987734492
Rem: Published: 2019-03-04T19:01:19+09:00
Category: batchfile
Updated: 2019-03-04T19:01:19+09:00
Title: C:\Program Files へファイルをコピーするバッチファイルの作り方
```
一般ユーザでは `C:\Program Files` 以下へファイルをコピーすることはできないので、管理者権限で自分自身を起動しなおすようにする。

**make.cmd**

```cmd.exe
setlocal
set "EXE=%~dp0\bin\Release\HogeHoge.exe"
call :"%1"
endlocal
exit /b

:"install"
    powershell Start-Process "%~dpnx0 install_" -verb runas
    exit /b

:"install_"
    copy "%EXE%" "C:\Program Files\nyaosorg\."
    copy "%EXE:.exe=.ini%" "C:\Program Files\nyaosorg\."
    pause
    exit /b
```

`make install` とタイプすると、UACダイアログが表示されるので、`はい(Y)`を選ぶと、管理者権限で目的のファイルを `C:\Program Files\nyaosorg` 以下へコピーしてくれる。

%~dp0 とか %EXE:exe=.ini% などは環境変数の置換で、これらは `cmd /h` 、 `cmd /c set /?` 、 `cmd /c for /?` などでガイドが出てくるので、そちらを参照いただきたい（つきはなし）
