Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2019/08/13/132804
Rem: App-Edited: 2023-04-29T10:10:27+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/26006613394315014
Rem: Published: 2019-08-13T13:28:04+09:00
Category: Go
Updated: 2019-08-13T13:28:04+09:00
Title:  strings.EqualFold はどの程度の速度か
---
* [Big Sky :: Go で大文字小文字無視の文字列比較ベンチマーク](https://mattn.kaoriya.net/software/lang/go/20190806152526.htm)

strings.EqualFold について言及がなかったので、測ってみました。

追加行：

```go
func isDevNull4(name string) bool {
    return strings.EqualFold(name,"nul")
}
func BenchmarkS4(b *testing.B) {
    test(b, isDevNull4)
}
```

結果：

```
$ go test -bench .
goos: windows
goarch: amd64
BenchmarkS1-4           50000000                29.5 ns/op
BenchmarkS2-4           50000000                29.1 ns/op
BenchmarkS3-4             200000              9844 ns/op
BenchmarkS4-4           20000000               101 ns/op
```

自分的には「[なんか、まぁまぁ速かったけど、速すぎるので、何かミスってる可能性大](https://twitter.com/zetamatta/status/1160917332018884608?s=20)」と思っていたんですが、「[そんなもんだと思います](https://twitter.com/mattn_jp/status/1160932314496417798?s=20)」とのコメントをいただきました。

まぁ、考えてみれば、S3 で使われている `strings.ToLower(name) == "nul"` は文字列の領域確保とインスタンス作成が入っているため、この結果は当然かもしれません。

mattn さん、どうもありがとうございました。