Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2019/09/22/080313
Rem: App-Edited: 2023-04-28T20:50:06+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/26006613437983279
Rem: Published: 2019-09-22T08:03:13+09:00
Category: C++
Updated: 2019-09-22T08:03:13+09:00
Title: std::vector / std::set 両方からデータを取れる関数をあまりテンプレートにしたくない
---
というような主旨のことを述べたら、boost::any_range
をオススメされました。

が、弊社では外部ライブラリの導入がめんどくさいので、boost といえど、あまり使いたくない（未だに Visual Studio 2010 がメインに使われてるようなところだからね）

とすると、コールバック関数かなぁ

```cpp
#include <iostream>
#include <vector>
#include <functional>
#include <set>

void put(std::function<bool(std::string&)> each)
{
    std::string value;
    while( each(value) ){
        std::cout << value << std::endl;
    }
}

int main()
{
    std::vector<std::string> v;
    v.push_back( "a" );
    v.push_back( "b" );
    v.push_back( "c" );

    auto p=v.begin();
    put( [&v,&p](std::string &value){ if( p == v.end() ){ return false; } value = *p ; p++ ; return true; } );

    std::set<std::string> s;
    s.insert( "a" );
    s.insert( "b" );
    s.insert( "c" );

    auto q=s.begin();
    put( [&s,&q](std::string &value){ if( q == s.end() ){ return false; } value = *q ; q++ ; return true; } );
}
```

```
$ gcc -std=c++14 it.cpp -lstdc++
$ a
a
b
c
a
b
c
```

うーん、呼び出しがすごく面倒くさい。

標準ライブラリに std::vector , std::set の既定クラス的な
std::collection とか std::enumerable とかあればよかったのに。

本件、たぶん、続きます。

+ 次回：[(続) std::vector / std::set 両方からデータを取れる関数をあまりテンプレートにしたくない - 標準愚痴出力](https://zetamatta.hatenablog.com/entry/2019/09/22/131156)