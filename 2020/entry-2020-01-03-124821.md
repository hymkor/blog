Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2020/01/03/124821
Rem: App-Edited: 2023-04-28T22:46:18+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/26006613492548354
Rem: Published: 2020-01-03T12:48:21+09:00
Category: go
Updated: 2020-01-03T12:48:21+09:00
Title:  IsNil を書いてみた
---
型が違っても nil 判定ができる関数を作ってみた。

```go
package main

import (
	"fmt"
	"reflect"
)

func IsNil(p interface{}) bool {
	if p == nil {
		return true
	}
	value := reflect.ValueOf(p)
	switch value.Kind() {
	case reflect.Ptr, reflect.Map, reflect.Slice, reflect.Interface, reflect.Chan, reflect.Func:
		return value.IsNil()
	default:
		return false
	}
}

type MyError struct{}

func (MyError) Error() string { return "MyError" }

func main() {
	var f error = (*MyError)(nil)

	fmt.Printf("(f == nil )==%v\n", f == nil)
	fmt.Printf("(IsNil(f) )==%v\n", IsNil(f))
}
```

```
$ go run typednil.go
(f == nil )==false
(IsNil(f) )==true
```

こんなんを書くとGo言語詳しい人が現れて御高説を始めがちだが、ここは人がこないから大丈夫だろう。分かってて書いてるんだよ。