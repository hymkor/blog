Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2020/09/28/105036
Rem: App-Edited: 2020-09-28T10:50:36+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/26006613633498221
Rem: Published: 2020-09-28T10:50:36+09:00
Category: .NET
Updated: 2020-09-28T10:50:36+09:00
Title: （.NET検証）FolderBrowserDialogを連続してShowDialogすると２回目以降は最前面に表示されない
---
件名そのまま。Microsoft のページは、いつ行方不明になるか分からないので、バックアップとして記事をあげておく。

* [FolderBrowserDialogを連続してShowDialogすると２回目以降は最前面に表示されない。](https://social.msdn.microsoft.com/Forums/ja-JP/5f5e248b-9073-4f93-b005-c55d5da66eae/folderbrowserdialog1243436899321541237512390showdialog12377124271239265298?forum=vbgeneralja)

この Q&A ページの要旨は以下のとおり：

1. １回目のフォルダー選択ウインドウを閉じた時点で、システムが他所のウインドウをアクティベートしてしまうため、２回目のフォルダー選択ウインドウがそれよりも背後になってしまう。
2.  対応策としては１回目のフォルダ―選択ウインドウを閉じた後に、親ウインドウをアクティベートして、DoEvent で処理させればよいらしい。
3.  だが、親ダイアログの Load イベント中でフォルダー選択ダイアログを表示させている場合、その中でまだ開かれていない親ウインドウをアクティベートすることはできない。
4. そこで、Load イベントでやっていたことを Shown イベントで行うようにした上で、親ウインドウ（というか自ウインドウか）のアクティベートを行うようにする。

実際やってみたところ、フォルダー選択ダイアログ２つを表示する場所を Loadイベントから Shown イベント中に移動させただけで直ってしまった。まぁ、親ウインドウをプログラムではなく、システムがアクティベートするから直ったというところだろうか。