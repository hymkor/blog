Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2021/01/06/151422
Rem: App-Edited: 2021-01-06T15:16:10+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/26006613674869715
Rem: Published: 2021-01-06T15:14:22+09:00
Category:
Updated: 2021-01-06T15:14:22+09:00
Title: Windows 8.1(64bit) に 32bit 系 OCX をインストールする
---
とある OCX を導入しようとしたが、うまくゆかない。手順書には
C:\Windows\system32 へコピー後、`regsvr32 C:\windows\system32\xxxxx.ocx` とあるが、コピーそのものができないのか、regsvr32 がファイルが見つからないというエラーが出る。

（無論、管理者権限にはしている。本来はここでエラーメッセージを引用すべきだが、実は解決して、コピーできなくなってしまったｗ）

そして、手製のバージョン確認ツールでも同ファイルを見ようとすると、同じようなエラーが出る。ただし、コピー元（デスクトップ）で実行すると、きちんとバージョン番号が出る。これはセキュリティー的な問題か！？

で、ググってみたところ、OCX の種類は違うが次のようなページにたどり着いた。

* [64ビット版Windows8.1への Comdlg32.ocx インストール方法（備忘録） - たーったったららったー 9M6NA](https://blog.goo.ne.jp/9m6na/e/4247f11a23bc97db4397de8e8b8265b7)

ここにある記載を真似て、コピー先を C:\Windows\System32 ではなく、C:\Windows\SysWOW64 にしてみたところ、regsvr32 も問題なく OCX を読み込むことができるようになった。wfile にも大丈夫だった。

その後、リポート用に上のエラーを再現させようと、C:\Windows\System32 に置いたバージョンについて wfile を実行してみたところ、エラーが出なくなってしまった！
このあたり、Windows のパスを差し替えるセキュリティー機能のせいだと思うけど、なかなか難しい話だなぁ
（どういうルールでこうなったか、よく分かっていない）