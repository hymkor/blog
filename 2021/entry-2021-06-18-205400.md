Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2021/06/18/205400
Rem: App-Edited: 2024-01-21T13:04:01+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/26006613777364601
Rem: Published: 2021-06-18T20:54:00+09:00
Category: WindowsTerminal
Updated: 2021-06-18T20:54:00+09:00
Title: WindowsTerminal の wt.exe が動かない
---
後々のためにメモ

環境 | Status | WindowsTerminal | OS
-|-|-|-
私用PC | OK | 1.8.1521.0 | 10.0.19043.1052
会社PC-1 | NG |  1.8.1521.0  | 10.0.19042.1052
会社PC-2 | NG |  1.8.1521.0  | 10.0.19042.1052

会社PC では

- Windows+R からの `wt.exe` ならば WindowsTerminal が起動する
- CMD.EXE からの `start wt.exe` だと次のようなエラーダイアログが出る

[f:id:zetamatta:20210618204948p:plain]

私用PC では、Windows+R でも、`start wt.exe` でも、どちらでも WindowsTerminal が起動できる。

うむ、なんでじゃろね

### レジストリを確認

#### OK環境

* キー
    * `コンピューター\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\wt.exe`
* 値：
    * `C:\Program Files\WindowsApps\Microsoft.WindowsTerminal_1.8.1521.0_x64__8wekyb3d8bbwe`

同パスに実際に wt.exe が存在した

#### NG環境

* キー
    * `コンピューター\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\wt.exe`
* 値
    * `C:\Program Files\WindowsApps\Microsoft.WindowsTerminal_1.7.1033.0_x64__8wekyb3d8bbwe`

1.7 のフォルダーは存在しない。1.8 のフォルダーなら存在する。

そっかーーー

### いろいろググってみたところ

%LOCALAPPDATA%\Microsoft\WindowsApps には必ず wt.exe がある模様。

ファイルサイズは 0 バイトなので、おそらくはこれもエイリアスであろうと思われるが、こちらは OK 環境・NG 環境でも動作する。これでなんとかするかー
