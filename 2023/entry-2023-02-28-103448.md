Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2023/02/28/103448
Rem: App-Edited: 2024-01-21T12:59:56+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/4207112889967185291
Rem: Published: 2023-02-28T10:34:48+09:00
Category: Go
Updated: 2023-02-28T10:34:48+09:00
Title: defer による戻り値の差し替え
---
（先日、gist に書いたものをこちらへ移動）

```go
package main

func sub() (rc int) {
    defer func() {
        println("defer func():", rc)
        rc *= 2
    }()

    rc = 1
    return 2
}

func main() {
    rc := sub()
    println("main:", rc)
}
```

```
$ go run defer.go
defer func(): 2
main: 4
```

まとめ

- defer は戻り値の値を、戻り値に割り当てられた変数（例では rc）から得て、差し替えることができる
- `return 2` は `rc = 2 ; return` と等価
