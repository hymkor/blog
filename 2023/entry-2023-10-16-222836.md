Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2023/10/16/222836
Rem: App-Edited: 2024-01-21T12:54:50+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/6801883189050811313
Rem: Published: 2023-10-16T22:31:06+09:00
Category: htnblog Go
Updated: 2023-10-16T23:35:00+09:00
Title: はてなブログの記事を作成・編集するGoのライブラリ・コマンドラインツールを作りました
---
- [hymkor/go-htnblog: はてなブログ投稿Goライブラリ](https://github.com/hymkor/go-htnblog)

いい加減ウェブブラウザで、markdown を編集するのはしんどくて、vim で編集するために作りました[^mukashi]。

[^mukashi]: 昔は w3m や Firefox のアドオンでなんとかできたりしたもんですが…

※ **(2023-10-17 追記)** 記事公開後、不具合が見付かり、[v0.1.1] → [v0.2.0] と更新しているので、ご注意ください

[v0.1.1]: https://github.com/hymkor/go-htnblog/releases/tag/v0.1.1
[v0.2.0]: https://github.com/hymkor/go-htnblog/releases/tag/v0.2.0

はてなブログは [API] も公開されているので、この手のツールはありそうなんですが、Ruby製だったり[^ruby]、Go製だけどライブラリではなくて、１実行ファイルに閉じたツールだったりして、ちょっと好みのものがありませんでした。

[^ruby]: Ruby は分からないでもないが、Windowsで日常使いしていないし、このためだけに入れるのもめんどうくさかったし、Goみたいにシンブルバイナリでもないし(グダグダ)

[API]: https://developer.hatena.ne.jp/ja/documents/blog/apis/atom/

ということで、Go言語でクリーンアーキテクチャっぽく作りました。

- ライブラリ(go-htnblog)は https://github.com/hymkor/go-htnblog
- ツール(htnblog.exe)は https://github.com/hymkor/go-htnblog/cmd/htnblog

となります。

自分のスタンスとしては、すべての操作をコマンドラインで完結させようとは思ってなくて、記事の新規作成と直近の記事の編集だけ出来れば十分だと考えているので、ツールの方も

- `htnblog new` … 記事の新規作成。いきなり公開ではなく、ドラフトを作るだけ
- `htnblog edit` …  最新の記事を編集する。公開状態は編集しない
- `htnblog list` … 直近7つの記事のリストを表示するだけ

とサブコマンドが3つだけあります。テキストの原本はウェブ側においておいて、プレビューとか、削除とか、古い記事の編集とかブラウザでやって頂戴というスタンスです。
（もっとも、それ以上やりたい人もいるだろうから、プルリクなりイシューなりもらったら、修正もやぶさかではありません）

Windows版の htnblog.exe は例によって

```
scoop bucket add hymkor https://github.com/hymkor/scoop-bucket
scoop install htnblog
```

でインストール可能です。

今後の TODO
-----------

- ~~タグの編集機能 (今はブラウザで設定しても再編集で多分消えちゃう)~~[^notag]
- 直近の記事以外も編集できるようにする
- 現行はBASIC認証でやってる → OAuth に変えた方がいいかも

[^notag]: API経由でタグの読み書きは出来なかった。そのかわり、ウェブで設定されたタグも本ツールでの更新で消えたりはしない模様
