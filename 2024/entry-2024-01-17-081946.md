Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2024/01/17/081946
Rem: App-Edited: 2024-01-21T11:56:37+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/6801883189075689455
Rem: Published: 2024-01-17T08:33:02+09:00
Category: htnblog
Updated: 2024-01-17T08:19:46+09:00
Title: はてなブログ・コマンドラインクライアント v0.7.0 を公開した。
---
+ [Release v0.7.0 · hymkor/go-htnblog](https://github.com/hymkor/go-htnblog/releases/tag/v0.7.0)

はてなブログ・コマンドラインクライアント v0.7.0 を公開しました。[f:id:zetamatta:20240117100205p:plain]

#### `htnblog init` で設定の編集をできるようにした

jsonファイルの文法を知らなくても、設定の編集をすることができるようになりました。

```
$ htnblog init
Hatena-id ? (← Hatena-IDを入力)
API-KEY ? (← APIキー入力)
End Point URL 1 ? (← 一つ目のブログのEndPointURL を入力)
End Point URL 2 ? (← 二つ目のブログのEndPointURL を入力:Enterのみで省略可)
End Point URL 3 ? (← 三つめのブログのEndPointURL を入力:Enterのみで省略可)
End Point URL (default) ? (← デフォルトのブログの EndPointURL: 既定値は1と同じ)
Text Editor Path ? (← テキストエディタのパス: 既定値は%EDITOR%)
Saved configuration to C:\Users\hymkor\.htnblog
```

go-readline-ny を使っているので、Emacs-like な編集ができます。また、デフォルト値として、元々の JSON ファイル(~/.htnblog)に入っている値が入力行に入ります。

本当はホームディレクトリ直下の dotfile ではなく、%APPDATA% or ~/.config/ 以下にサブディレクトリを切って、その下に移動しようかとも思ったのですが、大層なので今回は見送りました。

#### ヘッダ関連

```
Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2024/01/09/095250
Rem: App-Edited: 2024-01-09T10:41:32+09:00
Rem: Draft: no
Rem: Edit-Url: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/6801883189073619485
Rem: Published: 2024-01-09T10:40:16+09:00
Updated: 2024-01-09T09:52:50+09:00
Title: Cargo.toml からバージョンを抽出する
---
```

こんな感じに、本文前のヘッダを充実させました。

##### 記事の日付を変えられるように、Updated: ヘッダをドラフトに用意

前は `-updated` オプションで変更できるようにしていたのですが、ヘッダ部分で変更できるようにしました。書式は `time.RFC3339` ですが、間違っていた場合は再編集になります。エラーメッセージは Rem: ヘッダに挿入されます。

##### 変更できない記事データも、参考のためドラフトの Rem: ヘッダに列挙するようにした

はてなブログの API、結構、READONLY な項目多いですよね… 一応、参考のため、ヘッダに表示させるようにしたのですが、変更できると誤解させてはいけないので、`Rem: `というプリフィックスを付けました。

`Rem: Alternate-Url:` はブラウザで表示する際の URL、`Rem: Edit-URL:` は API で編集する際の URL です。

#### 今後の展望

バージョンも v0.7.0 になりました。そろそろ、v1.0.0 にしてもよい頃かもしれません。

今のところできないことは

+ 「下書き」から「公開」への切り替え  
    U/I が悩みどころです。API の仕様上、「下書き」を「公開」することはできるが、「公開」したものを「下書き」へ戻せないようなのです。それが分かるような表現にする必要があります。
+ タグの付与  
    API の仕様的にできたかなぁ…(要確認)

といったところでしょうか。API で出来ることって、意外と必要最小限だったりするみたいなんですよねー。APIって、提供する側にとっては、労多い割に益が少ない機能ですからねぇ…
