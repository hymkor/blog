```header
Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2024/02/21/111146
Rem: App-Edited: 2024-03-23T12:11:17+09:00
Rem: Draft: yes
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/6801883189084896157
Rem: Published: 2024-02-22T03:47:58+09:00
Category:
Updated: 2024-02-21T11:11:46+09:00
Title: バックアップツール restic おためし中
```
[restic]: https://restic.readthedocs.io/en/latest/

+ [resticとRustとCACHEDIR.TAG - methaneのブログ](https://methane.hatenablog.jp/entry/2024/02/20/restic%E3%81%A8Rust%E3%81%A8CACHEDIR.TAG)

以前から、マインクラフトのゲームデータのバックアップをいろいろ試行錯誤してきたが

1. tar → zstd → curl → ftp
    + tarのサイズが大きすぎて、verify 時にエラーが確認される
2. マインクラフトの標準のバックアップ先 `%APPDATA%\.minecraft\backups` 以下を OneDrive の下へのジャンクション化
    + OneDrive の容量がギリギリで過去1回分しか取れない (2回分も残すつもりはないが、1回目のバックアップが終わるまで、その前のバックアップは残しておきたい)

と、いろいろとうまくいっていなかったため、[restic] を試してみた。 `scoop install restic` でインストールだ。

#### 初回バックアップ

```
C:> cd "%APPDATA%\.minecraft"
C:> restic.exe --repo ~\OneDrive\Documents\minecraft-backups init
C:> restic.exe --repo ~\OneDrive\Documents\minecraft-backups backup saves
```

**すごく重い**。CPU負荷には余裕があるが、ディスク負荷が 100% に張りついている。これは圧縮をあんまりしてないっぽいなぁ

+ バックアップ元：7.2G `%APPDATA%\.minecraft\saves\` (3681 files)
+ バックアップ先：5.7G `~\OneDrive\Documents\minecraft-backups` (605 files)
+ 初回所要時間：23分(restic) + OneDrive 同期時間

#### 2回目のバックアップ

```
C:> restic.exe --repo ~\OneDrive\Documents\minecraft-backups backup saves
enter password for repository:
repository a8ee745d opened (version 2, compression level auto)
using parent snapshot d88cd20f
[0:00] 66.67%  2 / 3 index files loaded

Files:           0 new,    87 changed,  3541 unmodified
Dirs:            0 new,    15 changed,    38 unmodified
Added to the repository: 149.510 MiB (132.221 MiB stored)

processed 3628 files, 6.713 GiB in 0:16
snapshot 86b8686f saved

C:> restic.exe --repo ~\OneDrive\Documents\minecraft-backups snapshots
enter password for repository:
repository a8ee745d opened (version 2, compression level auto)
ID        Time                 Host             Tags        Paths
------------------------------------------------------------------------------------------------------------
d88cd20f  2024-02-21 10:11:35  DESKTOP-NPOTG52              C:\Users\hymkor\AppData\Roaming\.minecraft\saves
86b8686f  2024-02-22 03:41:16  DESKTOP-NPOTG52              C:\Users\hymkor\AppData\Roaming\.minecraft\saves
------------------------------------------------------------------------------------------------------------
2 snapshots
```

16秒!? すごく速い。これならプレイ後、毎回バックアップ取れる。いいな、これ
