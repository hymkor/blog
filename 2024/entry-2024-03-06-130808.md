Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2024/03/06/130808
Rem: App-Edited: 2024-03-06T13:08:08+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/6801883189088596080
Rem: Published: 2024-03-06T13:08:08+09:00
Category:
Updated: 2024-03-06T13:08:08+09:00
Title: $GOEXPERIMENT を定義すると、runtime.Version() の値がかわる
---
```go
package main

import (
    "runtime"
)

func main(){
    println(runtime.Version())
}
```

未定義の時：

```
C:> go run foo.go
go1.22.0
```

$GOEXPERIMENT に rangefunc を設定した時：

```
C:> env.exe GOEXPERIMENT=rangefunc go run foo.go
go1.22.0 X:rangefunc
```

### 余談

これの実験中に拙作の [env for Windows][env-rs] に不具合が見付かった。`go1.22.0 X:rangefunc`が表示される前に、プロンプトが表示されるのだ。

さくっと修正した。

+ [Releases · hymkor/env-rs](https://github.com/hymkor/env-rs/releases)

```diff
--- a/src/main.rs
+++ b/src/main.rs
@@ -32,7 +32,7 @@
                 println!("call {}", arg);
             }
             let param: Vec<String> = args.collect();
-            if let Err(err) = std::process::Command::new(arg).args(param).spawn() {
+            if let Err(err) = std::process::Command::new(arg).args(param).status() {
                 return Err(Box::new(err));
             } else {
                 return Ok(());
```

[env-rs]: https://github.com/hymkor/env-rs
