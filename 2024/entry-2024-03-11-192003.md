```header
Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2024/03/11/192003
Rem: App-Edited: 2024-03-11T19:29:50+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/6801883189089949008
Rem: Published: 2024-03-11T19:20:03+09:00
Category: golang go generics
Updated: 2024-03-11T19:20:03+09:00
Title: Go で適当な btree を検討していたけど、tidwall/btree がいいかもしれないなぁ
```
+ [tidwall/btree: B-tree implementation for Go](https://github.com/tidwall/btree)

既存のメソッド Scan の仕様が range から呼ばれた関数の要求仕様にちょうどマッチしてた。

```go
package main

import (
    "fmt"

    "github.com/tidwall/btree"
)

func main() {
    var users btree.Map[string, string]

    // add some users
    users.Set("user:4", "Andrea")
    users.Set("user:6", "Andy")
    users.Set("user:2", "Andy")
    users.Set("user:1", "Jane")
    users.Set("user:5", "Janet")
    users.Set("user:3", "Steve")

    // Iterate over the maps and print each user
    for key, value := range users.Scan {
        fmt.Printf("%s %s\n", key, value)
    }
}
```

```
$ env GOEXPERIMENT=rangefunc go run main.go
user:1 Jane
user:2 Andy
user:3 Steve
user:4 Andrea
user:5 Janet
user:6 Andy
```

[tidwall] さんは、[transform] というフィルターパッケージの開発者で、よいプロダクトをいろいろ作ってる人なので、もうこれでいいかなぁ感
( これのSTAR数も前に確認した2022-04-30時点から、680→982 に増えてる )

[transform]: https://github.com/tidwall/transform
[tidwall]: https://github.com/tidwall
