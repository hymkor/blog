```header
Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2024/03/26/232949
Rem: App-Edited: 2024-03-27T02:09:32+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/6801883189093838480
Rem: Published: 2024-03-26T23:29:49+09:00
Category: jj jujutsu git
Updated: 2024-03-26T23:29:49+09:00
Title: Git 互換DVCS、jj(jujutsu) でのテキストエディター指定における空白の扱い
```
基本は

+ [Settings - Jujutsu docs](https://martinvonz.github.io/jj/v0.15.1/config/#editor)

に記載のとおり

1. 環境変数 JJ\_EDITOR
2. 設定ファイルの ui.editor
3. 環境変数 VISUAL
4. 環境変数 EDITOR

の順で参照される。この時、1,3,4 について**空白**は引数の絶対的な区切リ文字として機能する。つまり

+ `set "EDITOR=C:/Program Files/Notepad++/notepad++.exe"` → NG
+ `set "EDITOR=\"C:/Program Files/Notepad++/notepad++.exe\""` → NG
+ `set "EDITOR=""C:/Program Files/Notepad++/notepad++.exe"""` → NG
+ `set "EDITOR=^"C:/Program Files/Notepad++/notepad++.exe^""` → NG  
+ `set "EDITOR=notepad++.exe"` → OK (%PATH% にディレクトリが登録されている場合)
+ `set "EDITOR=C:\PROGRA~1\Notepad++/notepad++.exe\""` → OK
+ `set "JJ_EDITOR=C:\PROGRA~1\vim\vim91\vim.exe --literal"` → OK

となるようだ。なお、`C:\PROGRA~1` は `C:\Program Files` のショートファイル名(DOS互換の8.3形式のファイル名) だが、常にそうとは限らない。

2についても単純な文字列として設定する場合は 1,3,4 と同じ扱いになるが、配列として定義する場合のみ、空白を設定可能になる。つまり、以前

+ [(解決編) jujutsu v0.15.1 で、コミットログを gvim.exe で編集できなくなってしまった - 標準愚痴出力](https://zetamatta.hatenablog.com/entry/2024/03/09/031903)

で記載した書き方になる。

```
[ui]
editor = [ "C:/Program Files/vim/vim91/vim.exe", "--literal" ]
```

ただし、この設定は `jj config edit --repo` でしか設定できず、`jj config get ui.editor` で現在の設定内容を確認できなくなるという制限があるようだ。うーん

### ちなみに Git も

```
$ set "GIT_EDITOR=C:/Program Files/Vim/vim91/vim.exe"

$ git commit --amend
hint: Waiting for your editor to close the file... C:/Program Files/Vim/vim91/vim.exe: line 1: C:/Program: No such file or directory
error: There was a problem with the editor 'C:/Program Files/Vim/vim91/vim.exe'.
Please supply the message using either -m or -F option.
```

おんなじだった。
