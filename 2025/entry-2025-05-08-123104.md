Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2025/05/08/123104
Rem: App-Edited: 2025-05-08T12:31:04+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/6802418398416577235
Rem: Published: 2025-05-08T12:31:04+09:00
Category:
Updated: 2025-05-08T12:31:04+09:00
Title: gmnlisp v0.7.10 と lispect 0.6.0 を公開しました
---
きっかけとしては自作のコマンドラインの自動化ツール [Lispect] で[プルリクエスト][#1]をいただいたことです。

内容としては、ユーザのGoアプリケーション内からコマンドラインの自動化ができるよう、単体実行ファイル形式だけでなく、ライブラリパッケージとして使えるようにするという提案でした。残念ながらパッケージ構造などについて、自分の方針とやや異なっていたため直接のマージはできなかったのですが、ニーズ自体はよく理解できるものであったため、自分のやり方で再実装させていただきました（コード自体はマージしませんでしたが、プルリクエストしてくださった方の貢献は大変意義深いものでしたので、README に謝辞を明記させていただきました）

さて、プルリクエストをいただいたということは、実際に使ってくださっている方がいるということで、一気にプレッシャーが高まります。つまり、そろそろ互換性を意識しないといけないと。

前からの懸案として、[ISLisp] の規格として、シンボルの英大文字・小文字の区別をしないという仕様があるのに対して、[Lispect] は `ARGV`、`PROGRAM-NAME`、`EXECUTABLE-NAME`、`MATCH` といった英大文字だけからなるシステム変数を用意している点がありました。将来的に英大文字・小文字の区別をなくすとなると、その際、`argv`、`program-name`、`executable-name`、`match` と等価となり、ユーザ変数とシステム変数を区別する特徴がなくなります。これらは早めに対応しておいた方が傷が小さくて済みます。

まず、ISLisp 言語エンジン [gmnlisp] 側への対応を行いました。

* [Release v0.7.10 · hymkor/gmnlisp](https://github.com/hymkor/gmnlisp/releases/tag/v0.7.10)

半年ぶりの更新ですが、あいかわらず ISLisp の規格準拠を進めていました。今回の更新で、[検証プログラム][verification]のスコアが、OK = 11040, NG = 5371 から  OK = 11533, NG = 4878 と500点分改善しています。そして、その上で思い切って英大文字・小文字の区別を撤廃する対応に踏み切りました

- [Release v0.6.0 · hymkor/lispect](https://github.com/hymkor/lispect/releases/tag/v0.6.0)

import している gmnlisp を v0.7.10 へアップデートした上で、グローバル変数の名称変更を行いました。新しい名前は  `*argv*`、`*program-name*`、`*executable-name*`、および `*match*` となります。以前の名前は非推奨となるものの、互換性のため、当面のあいだは引き続き使用可能としました。

---

Lispect 自体の機能は完成しているので、今後のアップデートは [gmnlisp] の [ISLisp] 準拠度の向上がメインになると思います。[ISLisp] 対応でのネックは情報の少なさで、いつも JIS の読みやすいとはいえない規格書などをなんとか読み解いていました。規格書というのは入門書ではないので、なかなかの苦行です。

ですが、[ChatGPT] が意外と [ISLisp] に詳しいということが判明しました。彼（ChatGPT）に聞けば、英語圏にしか存在しないような情報を含め、いろいろと日本語で教示してくれます。無論、100%間違いがないと保証されるものではありませんが、幸い [ISLisp] には処理系が [ISLisp の規格に準拠できているのかを検証するプログラム][verification]が公開されています。これによって、自分の認識の妥当性が担保できるのではないかと考えています。

いや、まじでえらい時代になったもんですね。

[ISLisp]: https://www.islisp.org/index-jp.html
[ChatGPT]: https://chatgpt.com/
[gmnlisp]: https://github.com/hymkor/gmnlisp
[verification]: https://islisp.org/jp/verification-jp.html
[#1]: https://github.com/hymkor/lispect/pull/1
[Lispect]: https://github.com/hymkor/lispect