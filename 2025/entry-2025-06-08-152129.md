```header
Rem: Alternate-Url: https://zetamatta.hatenablog.com/entry/2025/06/08/152129
Rem: App-Edited: 2025-06-08T15:29:05+09:00
Rem: Draft: no
Rem: Url-To-Edit: https://blog.hatena.ne.jp/zetamatta/zetamatta.hatenablog.com/atom/entry/6802418398466232817
Rem: Published: 2025-06-08T15:21:29+09:00
Category:
Updated: 2025-06-08T15:21:29+09:00
Title: AIM Toolkit で RAM DISK をセットアップ
```
前回：[Windows で RAM DISK ソフトウェアの選定 2025 - 標準愚痴出力](https://zetamatta.hatenablog.com/entry/2025/06/08/142601)

- [AIM Toolkit download | SourceForge.net](https://sourceforge.net/projects/aim-toolkit/)

より、AIMtk.zip をダウンロード。unzip するとインストーラーが展開される

```
> unzip ~/Downloads/AIMtk.zip
Archive:  C:/Users/hymko/Downloads/AIMtk.zip
   creating: AIMtk20250521/
  inflating: AIMtk20250521/files.cab
  inflating: AIMtk20250521/install.bat
```

install.bat を実行すると、管理者権限を求められ、`c:\Program Files\AIM Toolkit` にファイルが展開される。スタートメニューの `AIM Toolkit` → `RamDisk Configuration` を起動して、RAM DISK を設定する。

[f:id:zetamatta:20250608150836p:plain]

- ドライブはデフォルトのまま `R:` とした
- デフォルトのサイズは数MB だったが、4GB とした
- %TEMP% を変更するのは危険だと考えたので、変更しなかった。

これで OK をすると、次のような警告が出た。

> Warning: the fast startup feature of Windows is enabled. This can lead to some issues:
>
> - The system writes the ramdisk content onto the hard drive at shutdown, and restores it at startup.
> -  The data synchronization feature of AIM Toolkit does not work at system shutdown.
>
> Open the Shutdown settings to disable the fast startup.

要は Windows 10 からのデフォルトとなった「高速スタートアップ」が有効になっていると、本来クリアされるはずの RAM DISK の内容がハードディスクもしくは SSD 経由で復元されてしまうため、RAM DISK のドライバーが正常動作しなくなる恐れがあるということらしい。

次の手順で無効化した。

1. 「スタート」→「コントロールパネル」→「ハードウェアとサウンド」
2. 「電源オプション」→「電源ボタンの動作を選択」
3. 上部の「現在利用可能ではない設定を変更します」をクリック
4. 「高速スタートアップを有効にする（推奨）」のチェックを外す
5. 「変更の保存」

あるいは管理者権限のコマンドラインから `powercfg /h off` でもよいとのこと（ 高速スタートアップを有効にするのは `powercfg /h on`、設定の確認は `powercfg /a` )

これを実行した後、再度、`RamDisk Configuration` を起動して、RamDisk を設定した。

DISKFREE コマンド[^3] で確認すると、4GB程度ほどのドライブができている

```
> diskfree
          Available             Total       TotalFree Use%
C:\ 902,669,897,728 1,021,821,579,264 902,669,897,728   11 NTFS FIXED Windows
R:\   4,270,559,232     4,294,963,200   4,270,559,232    0 NTFS FIXED RamDisk
```

[^3]: nyagos の内蔵コマンド
